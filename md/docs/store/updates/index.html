<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../../../img/favicon.ico">
  <title>Automatic Updates - nyaf Documentation</title>
  <link rel="stylesheet" href="../../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Automatic Updates";
    var mkdocs_page_input_path = "md/docs/store/updates.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
<style>
  body, p, pre > code {
    font-size: 1.1em;
  }
  li code {
    font-size: 1.0em;
  }
  code {
    font-size: 1.0em;
    border: none;
    background-color: transparent;
  }
  .wy-nav-content { max-width: none; }
  a.toctree-l4 {
    margin-left: 10px;
  }
  blockquote {
    border-left: 5px gray solid;
    background-color: lightgray;
    padding: 10px 10px 1px 10px;
  }
</style>


  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../../.." class="icon icon-home"> nyaf Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../../../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../../intro/">Introduction</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../../learn/">Learn</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../../ts/">Project Configuration (TS)</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../../babel/">Project Configuration (JS)</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../../config/">Configuration Files</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Core Library</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../lib/overview/">Overview</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/template/">Template Language</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/jsx/">JSX / TSX</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/select/">Select Elements</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/smart/">Smart Components</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/lifecycle/">Life Cycle</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/attributes/">Attributes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/directives/">Directives</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/events/">Events</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/router/">Router</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/shadowdom/">Shadow DOM</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/services/">Services</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Forms Extension</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../forms/overview/">Overview</a>
                </li>
                <li class="">
                    
    <a class="" href="../../forms/vm/">View Models</a>
                </li>
                <li class="">
                    
    <a class="" href="../../forms/nbind/">Data Binding</a>
                </li>
                <li class="">
                    
    <a class="" href="../../forms/validation/">Validation</a>
                </li>
                <li class="">
                    
    <a class="" href="../../forms/custombinders/">Custom Binders</a>
                </li>
                <li class="">
                    
    <a class="" href="../../forms/setup/">Setup</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Flux Store</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../overview/">Overview</a>
                </li>
                <li class="">
                    
    <a class="" href="../example/">Store Example</a>
                </li>
                <li class="">
                    
    <a class="" href="../globloc/">Global and Local Stores</a>
                </li>
                <li class="">
                    
    <a class="" href="../dispose/">Disposing Subscriptions</a>
                </li>
                <li class="">
                    
    <a class="" href="../effects/">Effects Mapping</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Automatic Updates</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#automatic-updates">Automatic Updates</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#the-updates-decorator">The Updates Decorator</a></li>
        
            <li><a class="toctree-l4" href="#using-the-updates-decorator">Using the Updates Decorator</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../setup/">Setup</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Comparision of @nyaf with...</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../comparision/angular/">...Angular</a>
                </li>
                <li class="">
                    
    <a class="" href="../../comparision/polymer/">...Polymer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../comparision/preact/">...Preact</a>
                </li>
                <li class="">
                    
    <a class="" href="../../comparision/react/">...React</a>
                </li>
                <li class="">
                    
    <a class="" href="../../comparision/stencil/">...Stencil</a>
                </li>
                <li class="">
                    
    <a class="" href="../../comparision/svelte/">...Svelte</a>
                </li>
                <li class="">
                    
    <a class="" href="../../comparision/vue/">...Vue</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Internals</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../internals/about/">About</a>
                </li>
                <li class="">
                    
    <a class="" href="../../internals/lic/">Licence</a>
                </li>
                <li class="">
                    
    <a class="" href="../../internals/start/">How it's being made</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../..">nyaf Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../..">Docs</a> &raquo;</li>
    
      
        
          <li>Flux Store &raquo;</li>
        
      
    
    <li>Automatic Updates</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/joergkrause/nyaf/edit/master/docs/md/docs/store/updates.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h2 id="automatic-updates">Automatic Updates<a class="headerlink" href="#automatic-updates" title="Permanent link">#</a></h2>
<p>The <code>@Updates</code> decorator complements the <code>@Effects</code> decorator. The schema is similar. However, both decorators work independently of each other and you can use any or both.</p>
<h3 id="the-updates-decorator">The Updates Decorator<a class="headerlink" href="#the-updates-decorator" title="Permanent link">#</a></h3>
<p>The decorator exists once on a component. The API looks like this:</p>
<pre><code class="ts">@Updates(Update[])
</code></pre>

<p>It makes only sense in conjunction with the store itself (a missing store will throw an exception). This is how it goes with a real component:</p>
<pre><code class="ts">@CustomElement('app-store-effects')
@ProvideStore&lt;allStoreTypes&gt;(store)
@Updates&lt;allStoreTypes&gt;([
  {
    store: 'counter',
    selector: '[data-store-counter]',
    target: 'textContent'
  }
])
export class StoreUpdateComponent extends BaseComponent&lt;{ cnt: number }&gt; implements IStore&lt;allStoreTypes&gt; {
}
</code></pre>

<p>The piece of HTML that this <code>@Update</code> decorator setting addresses is shown below:</p>
<pre><code class="tsx">&lt;div class='badge badge-info' data-store-counter&gt;n/a&lt;/div&gt;
</code></pre>

<p>There is no additional code required to update the HTML. Once a change in the store ocurred the value is pulled from the store and written into the selected property. In the example the store's value 'counter' is monitored by a subscription. The elements are being selected once in the lifecycle state <code>Load</code>. Further changes of the component's DOM are not being processed. The access works with or without shadow DOM. The element's selector in the example is '[data-store-counter]'. You can use any selector <code>querySelectorAll</code> would accept. If there are multiple elements indeed, the assignment will happen multiple times. The target property is 'textContent'. You can use any property that the selected element or component supports. Be aware that the access is property access on code level. That means, a virtual attribute of a component will not work, because it's not change in markup. If you have a component as the target, and wish to write a value to an observed attribute, you must introduce getter and setter methods to support the <code>@Update</code> decorator.</p>
<p>In the example the store definition (using <code>@ProvideStore</code>) and the update configuration (using <code>@Updates</code>) use the very same store type. That's not necessary. If the store type is a combined type (as in the example code you can find on Github), consider using one of its partial types for the update to shrink the selection to the part you really need. This avoids errors and improves the readability of your code.</p>
<h3 id="using-the-updates-decorator">Using the Updates Decorator<a class="headerlink" href="#using-the-updates-decorator" title="Permanent link">#</a></h3>
<p>The following code shows the typical store subscription, usually assigned in the constructor:</p>
<pre><code class="ts">this.sub = this.store.subscribe('counter', str =&gt; {
  this.querySelector('[data-store-counter]').textContent = str.counter;
});
</code></pre>

<p>The value is written in a freshly selected element. The very same result can be achieved with the following code:</p>
<pre><code class="ts">@Updates&lt;allStoreTypes&gt;([ {
    store: 'counter',
    selector: '[data-store-counter]',
    target: 'textContent'
}])
</code></pre>

<p>While this not seem to be a big advantage (in fact, 2 lines more), the real reason is to avoid <strong>any</strong> code in the component directly, making it pure view. On the long term this creates clean code and helps to make a  ore systematic structure.</p>
<p>The decorator accepts an array of objects of type <code>Update</code>. This type is an interface that has the following API:</p>
<ul>
<li><code>selector</code>: A string that can be handled by <code>querySelectorAll</code>.</li>
<li><code>store</code>: A string that is one of the properties of the store type. This is managed by the generic.</li>
<li><code>target</code>: A string that's the name of a property the selected element or component supports. This is not being checked by TypeScript.</li>
</ul>
<h4 id="the-selector">The Selector<a class="headerlink" href="#the-selector" title="Permanent link">#</a></h4>
<p>The selector is a string that can be handled by <code>querySelectorAll</code>. This is mandatory and the selector must return at least one element. The selector is executed after the life cycle event state <code>Load</code>. That means, that the <code>render</code> function is executed. The selector will not get any elements you add later dynamically.</p>
<p>To avoid any conflicts it's strongly recommended to use <em>data-</em> attributes and avoid any CSS stuff to select elements, especially not the <code>class</code> attribute.</p>
<h4 id="the-store">The Store<a class="headerlink" href="#the-store" title="Permanent link">#</a></h4>
<p>The store has usually a type definition to define the fundamental structure. Usually it's just an interface. The generic provides this type definition and you can choose any of these properties. Internally it's a <code>keyof T</code> definition.</p>
<h4 id="the-target">The Target<a class="headerlink" href="#the-target" title="Permanent link">#</a></h4>
<p>Because you can't write a value straight into an element or into a component you must define a specific property. The type is either any of the properties supported by <code>HTMLElement</code>or just a string. This is weak from standpoint of Intellisense (in fact, there is actually no check at all), but flexible enough to support all common scenarios.</p>
<p>It's a trade-off between convenience and security. A more rigid approach would require a generic on the level of the <code>Update</code> interface. But with an anonymous type definition you can't provide a generic. That means you need to add an additional type information. In the end it's a lot more boilerplate code for a little safety. That's the reason while the definition can be made so simple.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../setup/" class="btn btn-neutral float-right" title="Setup">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../effects/" class="btn btn-neutral" title="Effects Mapping"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/joergkrause/nyaf/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../effects/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../setup/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../../../..';</script>
    <script src="../../../../js/theme.js" defer></script>
      <script src="../../../../search/main.js" defer></script>

</body>
</html>
