<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../../../img/favicon.ico">
  <title>Data Binding - nyaf Documentation</title>
  <link rel="stylesheet" href="../../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Data Binding";
    var mkdocs_page_input_path = "md/docs/forms/nbind.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
<style>
  body, p, pre > code {
    font-size: 1.1em;
  }
  li code {
    font-size: 1.0em;
  }
  code {
    font-size: 1.0em;
    border: none;
    background-color: transparent;
  }
  .wy-nav-content { max-width: none; }
  a.toctree-l4 {
    margin-left: 10px;
  }
  blockquote {
    border-left: 5px gray solid;
    background-color: lightgray;
    padding: 10px 10px 1px 10px;
  }
</style>


  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../../.." class="icon icon-home"> nyaf Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../../../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../../intro/">Introduction</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../../learn/">Learn</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../../ts/">Project Configuration (TS)</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../../babel/">Project Configuration (JS)</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../../config/">Configuration Files</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Core Library</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../lib/overview/">Overview</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/template/">Template Language</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/jsx/">JSX / TSX</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/select/">Select Elements</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/smart/">Smart Components</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/lifecycle/">Life Cycle</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/attributes/">Attributes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/directives/">Directives</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/events/">Events</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/router/">Router</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/shadowdom/">Shadow DOM</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/services/">Services</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Forms Extension</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../overview/">Overview</a>
                </li>
                <li class="">
                    
    <a class="" href="../vm/">View Models</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Data Binding</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#data-binding">Data Binding</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#template-language-enhancements">Template Language Enhancements</a></li>
        
            <li><a class="toctree-l4" href="#terms-and-parts">Terms and Parts</a></li>
        
        </ul>
    

    <li class="toctree-l3"><a href="#creating-forms">Creating Forms</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#standard-binding-handlers">Standard Binding Handlers</a></li>
        
        </ul>
    

    <li class="toctree-l3"><a href="#smart-binders_1">Smart Binders</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#multi-attribute-binding">Multi Attribute Binding</a></li>
        
            <li><a class="toctree-l4" href="#even-more-smartness">Even More Smartness</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../validation/">Validation</a>
                </li>
                <li class="">
                    
    <a class="" href="../custombinders/">Custom Binders</a>
                </li>
                <li class="">
                    
    <a class="" href="../setup/">Setup</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Flux Store</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../store/overview/">Overview</a>
                </li>
                <li class="">
                    
    <a class="" href="../../store/example/">Store Example</a>
                </li>
                <li class="">
                    
    <a class="" href="../../store/globloc/">Global and Local Stores</a>
                </li>
                <li class="">
                    
    <a class="" href="../../store/dispose/">Disposing Subscriptions</a>
                </li>
                <li class="">
                    
    <a class="" href="../../store/effects/">Effects Mapping</a>
                </li>
                <li class="">
                    
    <a class="" href="../../store/updates/">Automatic Updates</a>
                </li>
                <li class="">
                    
    <a class="" href="../../store/setup/">Setup</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Comparision of @nyaf with...</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../comparision/angular/">...Angular</a>
                </li>
                <li class="">
                    
    <a class="" href="../../comparision/polymer/">...Polymer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../comparision/preact/">...Preact</a>
                </li>
                <li class="">
                    
    <a class="" href="../../comparision/react/">...React</a>
                </li>
                <li class="">
                    
    <a class="" href="../../comparision/stencil/">...Stencil</a>
                </li>
                <li class="">
                    
    <a class="" href="../../comparision/svelte/">...Svelte</a>
                </li>
                <li class="">
                    
    <a class="" href="../../comparision/vue/">...Vue</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Internals</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../internals/about/">About</a>
                </li>
                <li class="">
                    
    <a class="" href="../../internals/lic/">Licence</a>
                </li>
                <li class="">
                    
    <a class="" href="../../internals/start/">How it's being made</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../..">nyaf Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../..">Docs</a> &raquo;</li>
    
      
        
          <li>Forms Extension &raquo;</li>
        
      
    
    <li>Data Binding</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/joergkrause/nyaf/edit/master/docs/md/docs/forms/nbind.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h2 id="data-binding">Data Binding<a class="headerlink" href="#data-binding" title="Permanent link">#</a></h2>
<p>Data Binding is one of the most important features in component development. It brings an immediate effect in simplifying the data presentation layer. Instead of the chain "select" --&gt; "set" --&gt; "listen" --&gt; "change" you simply bind an object's properties to an element's attributes. That could go in both directions.</p>
<h3 id="template-language-enhancements">Template Language Enhancements<a class="headerlink" href="#template-language-enhancements" title="Permanent link">#</a></h3>
<p><strong>@nyaf</strong> has a simple template language extension for binding. For forms it's just one more command for any input element, <code>n-bind</code>. See the following excerpt from a component.</p>
<pre><code class="tsx">model: ModelBinder&lt;UserViewModel&gt;; // instance created by decorator

async render() {
  const model: UserViewModel = new UserViewModel(); // or where ever the model comes from
  return await (
    &lt;&gt;
      &lt;form&gt;
        &lt;input n-bind=&quot;value: Name&quot; /&gt;
      &lt;/form&gt;
    &lt;/&gt;);
}
</code></pre>

<p>Now the field knows everything about how to render and how to validate. The first item ("value")  is the HTML element's property you bind to. The second is the model's property name ("Name").</p>
<p>For a good UI you need a label usually:</p>
<pre><code class="html">&lt;label n-bind=&quot;innerText: userName&quot; /&gt;
</code></pre>

<h3 id="terms-and-parts">Terms and Parts<a class="headerlink" href="#terms-and-parts" title="Permanent link">#</a></h3>
<p>To understand the binding you must know what a view model is and what role the model plays inside the form.</p>
<h4 id="view-model">View Model<a class="headerlink" href="#view-model" title="Permanent link">#</a></h4>
<p>The actual definition of the model that is bindable is provided through the decorator <code>@ViewModel(T)</code>. <em>T</em> is a type (class) that has properties decorated with validation and UI decorators. More about this can be found in chapter <em>View Models</em>.</p>
<h4 id="imodel-interface">IModel<T> interface<a class="headerlink" href="#imodel-interface" title="Permanent link">#</a></h4>
<p>The <code>@ViewModel</code> decorator creates an instance of the model class. The interface enforces the visibility of the model in the component. The definition is quite easy:</p>
<pre><code class="ts">export interface IModel&lt;VM extends object&gt; {
    model: ModelBinder&lt;VM&gt;;
}
</code></pre>

<p>The instance of the modelbinder gives access to all binding features.</p>
<h4 id="binding-handlers">Binding Handlers<a class="headerlink" href="#binding-handlers" title="Permanent link">#</a></h4>
<p>Binding Handlers are small function calls that handle the data flow between viewmodel property and element attribute. There a few default binding handlers available.</p>
<h4 id="smart-binders">Smart Binders<a class="headerlink" href="#smart-binders" title="Permanent link">#</a></h4>
<p>Instead of using the string form you can use the TSX syntax and binding functions:</p>
<ul>
<li><code>to</code>: Generic function to bind a property to the default attribute using a custom binder optionally.</li>
<li><code>bind</code>: Generic function to bind a property to any attribute.</li>
<li><code>val</code>: Bind validation decorators to an attribute. See <a href="../validation/">validation</a>.</li>
</ul>
<p>See in Section <em>Smart Binders</em> for details.</p>
<h2 id="creating-forms">Creating Forms<a class="headerlink" href="#creating-forms" title="Permanent link">#</a></h2>
<p>The model is provided by the <code>@ViewModel</code> decorator and the <code>IModel&lt;T&gt;</code> interface like this:</p>
<pre><code class="tsx">@ViewModel(ModelType)
export class component extends BaseComponent&lt;any&gt; implements IModel&lt;ModelType&gt; {

  async render() {
    return await (
      &lt;form&gt;
        &lt;label n-bind=&quot;innerText: userName&quot; for=&quot;un&quot;/&gt;
        &lt;input n-bind=&quot;value: userName&quot; id=&quot;un&quot; /&gt;
        &lt;br /&gt;
        &lt;label n-bind=&quot;innerText: city&quot; for=&quot;city&quot;/&gt;
        &lt;input n-bind=&quot;value: city&quot; id =&quot;city&quot; /&gt;
     &lt;/form&gt;
    )
  }

}
</code></pre>

<p>The form now binds the data. It's bi-directional or uni-directional depending on the chosen binding handler.</p>
<h3 id="standard-binding-handlers">Standard Binding Handlers<a class="headerlink" href="#standard-binding-handlers" title="Permanent link">#</a></h3>
<p>The forms module comes with a couple of pre-defined binding handlers:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Key</th>
<th>Direction</th>
<th>Applies to</th>
<th>Base Element</th>
</tr>
</thead>
<tbody>
<tr>
<td>Default...</td>
<td>'default'</td>
<td>uni</td>
<td>attribute</td>
<td><code>HTMLElement</code></td>
</tr>
<tr>
<td>Checked...</td>
<td>'checked'</td>
<td>bi</td>
<td>attribute <code>checked</code></td>
<td><code>HTMLInputElement</code></td>
</tr>
<tr>
<td>Text...</td>
<td>'innerText'</td>
<td>uni</td>
<td>property <code>textContent</code></td>
<td><code>HTMLElement</code></td>
</tr>
<tr>
<td>Value...</td>
<td>'value'</td>
<td>bi</td>
<td>attribute <code>value</code></td>
<td><code>HTMLInputElement</code></td>
</tr>
<tr>
<td>Visibility...</td>
<td>'visibility'</td>
<td>uni</td>
<td>style <code>visibility</code></td>
<td><code>HTMLElement</code></td>
</tr>
<tr>
<td>Display...</td>
<td>'display'</td>
<td>uni</td>
<td>style <code>display</code></td>
<td><code>HTMLElement</code></td>
</tr>
</tbody>
</table>
<p>The actual handler names are <em>XXXBindingHandler</em> (<em>Default...</em> is actually <em>DefaultBindingHandler</em>). If in the binding attribute the text form is being used ('innerText: userName'), the <em>key</em> value determines the used handler.
The handler provides the active code that handles the change call and applies the changed value to the right target property. That can be any property the element type supports, directly or indirectly anywhere in the object structure. Such a deeper call happens in the style handlers, especially <code>VisibilityBindingHandler</code> and <code>DisplayBindingHandler</code>.</p>
<h2 id="smart-binders_1">Smart Binders<a class="headerlink" href="#smart-binders_1" title="Permanent link">#</a></h2>
<p>There is an alternative syntax that provides full type support:</p>
<pre><code class="tsx">&lt;label
  n-bind={to&lt;ContactModel&gt;(c =&gt; c.email, 'innerText', Display)}&gt;
&lt;/label&gt;
</code></pre>

<p>The function <code>to&lt;Type&gt;</code> from <strong>@nyaf/forms</strong> module has these syntax variations:</p>
<pre><code class="ts">to&lt;ViewModel&gt;(propertyExpression, handlerKey)
to&lt;ViewModel&gt;(propertyExpression, BindingHandlerType)
to&lt;ViewModel, ElementType&gt;(propertyExpression, handlerKey)
to&lt;ViewModel, ElementType&gt;(propertyExpression, BindingHandlerType)
to&lt;ViewModel&gt;(propertyExpression, handlerKey, UIDecoratorType)
to&lt;ViewModel&gt;(propertyExpression, BindingHandlerType, UIDecoratorType)
to&lt;ViewModel, ElementType&gt;(propertyExpression, handlerKey, UIDecoratorType)
to&lt;ViewModel, ElementType&gt;(propertyExpression, BindingHandlerType, UIDecoratorType)
</code></pre>

<p>The generic parameters are as follows:</p>
<ol>
<li>The view model type.  This is mandatory.</li>
<li>The element type. This is optional, if omitted it falls back to <code>HTMLElement</code>.</li>
</ol>
<p>The parameters are as follows:</p>
<ol>
<li>A lambda expression to select a property type safe (<code>c =&gt; c.name</code>). This is mandatory.</li>
<li>The key of a binding handler. Any property available in <code>HTMLElement</code> is allowed (and it's restricted to these).</li>
<li>The (optional) type of decorator that's used to pull data from. If it's omitted, the actual data appear.</li>
</ol>
<p>Obviously you could think about writing this:</p>
<pre><code class="tsx">&lt;input
  n-bind={to&lt;ContactModel&gt;(c =&gt; c.email, 'value')} /&gt;
</code></pre>

<p>This is rejected by the compiler, because the property <em>value</em> doesn't exists in <code>HTMLElement</code>. To provide another type, just use a second generic type parameter:</p>
<pre><code class="tsx">&lt;input
  n-bind={to&lt;ContactModel, HTMLInputElement&gt;(c =&gt; c.email, 'value')} /&gt;
</code></pre>

<p>Here you tell the compiler, that it's safe to use <code>HTMLInputElement</code> and so the editor allows <em>value</em> as the second parameter. An even smarter way is to use the lambda here, too:</p>
<pre><code class="tsx">&lt;input
  n-bind={to&lt;ContactModel, HTMLInputElement&gt;(c =&gt; c.email, c =&gt; c.value)} /&gt;
</code></pre>

<p>But, both ways are type safe, even the string is following a constrain. The string is usually shorter, the lambda might use an earlier suggestion from Intellisense.</p>
<blockquote>
<p>The binding behavior is tricky but powerful. The intention is to provide rock solid type safety. You must provide an element attribute that really exists to make a successful binding. Everything else wouldn't make any sense. But to actually bind properly, you must provide a Binding Handler that can handle this particular binding.</p>
</blockquote>
<h3 id="multi-attribute-binding">Multi Attribute Binding<a class="headerlink" href="#multi-attribute-binding" title="Permanent link">#</a></h3>
<p>The <code>n-bind</code> attribute is exclusive, so you can bind only one attribute. That's fine for most cases, but sometimes you'll need multiple bindings. In Angular this is easy through the binding syntax around any element (<code>&lt;input [type]="source" [value]="model"&gt;</code>). However, this would require a template compiler and additional editor support. To overcome the limitations here, the <code>bind</code> function is available.</p>
<p>In the next example two properties are bound:</p>
<pre><code class="tsx">&lt;input
  value={bind&lt;T&gt;(c =&gt; c.email)}
  type={bind&lt;T&gt;(c =&gt; c.toggleType)}
  n-bind /&gt;
</code></pre>

<blockquote>
<p>The <code>n-bind</code> is still required to efficiently trigger the binder logic. It's now empty, though (default value is <code>true</code> internally). Please note that you cannot bind to deeper structures in the current version (e.g. <code>style.border={bind&lt;T&gt;()}</code> is not possible.) That's typically a way to bind styles in Angular, but this would violate the rule that standard <strong>@nyaf</strong> templates shall be standard TSX files that any editor can handle without additional tool support. To support a scenario with style binding, refer to section <em>Custom Binders</em>.</p>
</blockquote>
<p>If the binding handler is not provided, it falls back to a <code>DefaultBindingHandler</code>, that binds uni-directional to the assigned attribute. That has two limitations. First, it's always uni-directional. Second, it can bind only to attributes of <code>HTMLElement</code>. Object properties, such as <code>textContent</code>or <code>innerText</code> cannot be reached that way. That's indeed the same with Angular, where you need to encapsulate elements in custom components to reach hidden properties, but in <strong>@nyaf</strong> there is a much smarter way.</p>
<p>Imagine you'll bind to whatever, just assign another binding handler.</p>
<pre><code class="tsx">&lt;input value={bind&lt;T&gt;(c =&gt; c.email, ValueBindingHandler)} n-bind /&gt;
</code></pre>

<p>The binding handler may write into whatever property you like, even those not available as attributes. See section <em>Custom Binders</em> for more details.</p>
<h3 id="even-more-smartness">Even More Smartness<a class="headerlink" href="#even-more-smartness" title="Permanent link">#</a></h3>
<p>You may also define your component as a generic. That avoids repeating the model name over and over again. Imagine this:</p>
<pre><code class="ts">// ContactModel defined elsewhere
export class ContactComponent&lt;T extends ContactModel&gt;
       extends BaseComponent&lt;any&gt;
       implements IModel&lt;ContactModel&gt; {
</code></pre>

<p>And in that case use a shorter form to express the binding:</p>
<pre><code class="tsx">&lt;label n-bind={to&lt;T&gt;(c =&gt; c.email, c =&gt; c.innerText)} /&gt;
</code></pre>

<blockquote>
<p><em>T</em> is a placeholder here. Use any name you like to define a "type".</p>
</blockquote>
<p>That's cool, isn't it? Now we have a fully type safe binding definition in the middle of the TSX part without any additions to regular HTML.</p>
<p>And in case you have special properties beyond <code>HTMLElement</code>, than just provide the proper type like you did before:</p>
<pre><code class="tsx">&lt;input n-bind={to&lt;T, HTMLInputElement&gt;(c =&gt; c.email, c =&gt; c.value)} /&gt;
</code></pre>

<p>This gives full type support in any editor for all types, even custom Web Components will work here.</p>
<blockquote>
<p>This technique avoids parsing the template, and the missing parser makes the package so small. The function simply returns a magic string that the model binder class recognizes at runtime. The function call with a generic helps the editor to understand the types and avoids mistakes.</p>
</blockquote>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../validation/" class="btn btn-neutral float-right" title="Validation">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../vm/" class="btn btn-neutral" title="View Models"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/joergkrause/nyaf/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../vm/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../validation/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../../../..';</script>
    <script src="../../../../js/theme.js" defer></script>
      <script src="../../../../search/main.js" defer></script>

</body>
</html>
