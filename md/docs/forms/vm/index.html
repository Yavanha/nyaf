<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../../../img/favicon.ico">
  <title>View Models - nyaf Documentation</title>
  <link rel="stylesheet" href="../../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "View Models";
    var mkdocs_page_input_path = "md/docs/forms/vm.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
<style>
  body, p, pre > code {
    font-size: 1.1em;
  }
  li code {
    font-size: 1.0em;
  }
  code {
    font-size: 1.0em;
    border: none;
    background-color: transparent;
    white-space: pre !important;
  }
  .wy-nav-content { max-width: none; }
  a.toctree-l4 {
    margin-left: 10px;
  }
  blockquote {
    border-left: 5px gray solid;
    background-color: lightgray;
    padding: 10px 10px 1px 10px;
  }
</style>


  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../../.." class="icon icon-home"> nyaf Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../../../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../../intro/">Introduction</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../../learn/">Learn</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../../ts/">Project Configuration (TS)</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../../babel/">Project Configuration (JS)</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../../config/">Configuration Files</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Core Library</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../lib/overview/">Overview</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/template/">Template Language</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/jsx/">JSX / TSX</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/select/">Select Elements</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/smart/">Smart Components</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/lifecycle/">Life Cycle</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/attributes/">Attributes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/directives/">Directives</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/events/">Events</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/router/">Router</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/shadowdom/">Shadow DOM</a>
                </li>
                <li class="">
                    
    <a class="" href="../../lib/services/">Services</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Forms Extension</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../overview/">Overview</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">View Models</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#view-models">View Models</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#why-using-view-models">Why Using View Models?</a></li>
        
            <li><a class="toctree-l4" href="#creating-a-view-model">Creating a View Model</a></li>
        
            <li><a class="toctree-l4" href="#validation-decorators">Validation Decorators</a></li>
        
            <li><a class="toctree-l4" href="#ui-decorators-property-level">UI Decorators (property level)</a></li>
        
            <li><a class="toctree-l4" href="#providing-the-viewmodel">Providing the ViewModel</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../nbind/">Data Binding</a>
                </li>
                <li class="">
                    
    <a class="" href="../validation/">Validation</a>
                </li>
                <li class="">
                    
    <a class="" href="../custombinders/">Custom Binders</a>
                </li>
                <li class="">
                    
    <a class="" href="../setup/">Setup</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Flux Store</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../store/overview/">Overview</a>
                </li>
                <li class="">
                    
    <a class="" href="../../store/example/">The Store Types</a>
                </li>
                <li class="">
                    
    <a class="" href="../../store/globloc/">Global and Local Stores</a>
                </li>
                <li class="">
                    
    <a class="" href="../../store/dispose/">Disposing Subscriptions</a>
                </li>
                <li class="">
                    
    <a class="" href="../../store/effects/">Effects Mapping</a>
                </li>
                <li class="">
                    
    <a class="" href="../../store/updates/">Automatic Updates</a>
                </li>
                <li class="">
                    
    <a class="" href="../../store/setup/">Setup</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Comparision of @nyaf with...</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../comparision/angular/">...Angular</a>
                </li>
                <li class="">
                    
    <a class="" href="../../comparision/polymer/">...Polymer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../comparision/preact/">...Preact</a>
                </li>
                <li class="">
                    
    <a class="" href="../../comparision/react/">...React</a>
                </li>
                <li class="">
                    
    <a class="" href="../../comparision/stencil/">...Stencil</a>
                </li>
                <li class="">
                    
    <a class="" href="../../comparision/svelte/">...Svelte</a>
                </li>
                <li class="">
                    
    <a class="" href="../../comparision/vue/">...Vue</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Internals</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../internals/about/">About</a>
                </li>
                <li class="">
                    
    <a class="" href="../../internals/lic/">Licence</a>
                </li>
                <li class="">
                    
    <a class="" href="../../internals/start/">How it's being made</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../..">nyaf Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../..">Docs</a> &raquo;</li>
    
      
        
          <li>Forms Extension &raquo;</li>
        
      
    
    <li>View Models</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/joergkrause/nyaf/edit/master/docs/md/docs/forms/vm.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h2 id="view-models">View Models<a class="headerlink" href="#view-models" title="Permanent link">#</a></h2>
<p>First, you need view models. Then, you decorate the properties with validation and hint decorators.</p>
<h3 id="why-using-view-models">Why Using View Models?<a class="headerlink" href="#why-using-view-models" title="Permanent link">#</a></h3>
<p>View Models form an abstraction layer between code and pure user interface. They appear in many architectural pattern, such as Model-View-Control (MVC), Movel-View-ViewModel (MVVM), and similar constructs. A component library such as <strong>@nyaf</strong> is a different kind of pattern, but the basic need for a model is still valid.</p>
<blockquote>
<p>The ViewModel is essential when you want a separation of concerns between your DomainModel (DataModel) and the rest of your code.</p>
</blockquote>
<p>Decoupling and separation of concerns is one of the most crucial parts of modern software architectures. Models can contain code, have actions, and work as a distinct translator between the domain model and the view. It's not the same as the business logic, it's a layer between such a layer and the user interface (UI). A UI contains logic to control visible elements, such as tooltips, hints, and validation information. All this has no or only a weak relation to an underlying business logic. Mixing the both will create code that is hard to maintain, complex, and difficult to read. In software technology we often talk about so called software entropy. That's the process of code going to change over time into an even harder to manage form, with a lot of hacks, bells, and whistles nobody understands completely and that wil eventually start to fail. Levels of abstraction help to delay this process (it's an illusion that you can avoid it entirely). Viewmodels are hence an essential part of a good architecture.</p>
<p>The flux architecture, delivered by the <strong>@nyaf/store</strong> module, seems to address a similar approach using store models and binding. However, this part is entirely devoted to the business logic. It's exactly that kind of abstraction we need to make great software not only by great design and an amazing stack of features, but by sheer quality, stability, with maintainable code, hard to break, and almost free of nasty bugs.</p>
<h3 id="creating-a-view-model">Creating a View Model<a class="headerlink" href="#creating-a-view-model" title="Permanent link">#</a></h3>
<p>A view model could look like this:</p>
<pre><code class="ts">export class UserViewModel {

  @Hidden()
  id: Number = 0;

  @Display('E-Mail', 'E-Mail address')
  @Required()
  @MaxLength(100)
  @Email()
  email: string = '';

  @Display('Phone Number', 'The user\'s phone')
  @Required('Please, the phone number is required')
  @MaxLength(20)
  phoneNumber: string = '';

  @Display('User Name', 'The full name')
  @Required()
  @MaxLength(100)
  userName: string = '';

}
</code></pre>

<p>The last (optional) parameter of the validation decorators is a custom error message.</p>
<h3 id="validation-decorators">Validation Decorators<a class="headerlink" href="#validation-decorators" title="Permanent link">#</a></h3>
<p>Validation decorators can be used together with the binding. After a binding action took place, usually after a change by the user, the state of the bound model updates and can be retrieved immediately. Elements bound to validation signals can use the state to show/hide elements or control sending data in code. The property names are the same as the respective decorators, just all lower case.</p>
<table>
<thead>
<tr>
<th>Decorator</th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>@MaxLength</strong></td>
<td>The maximum length of a text input.</td>
</tr>
<tr>
<td><strong>@MinLength</strong></td>
<td>The minimum length of a text input.</td>
</tr>
<tr>
<td><strong>@Pattern</strong></td>
<td>A regular expression that is used to test the text or number input.</td>
</tr>
<tr>
<td><strong>@Range</strong></td>
<td>A range (from-to) for either numerical values or dates.</td>
</tr>
<tr>
<td><strong>@Required</strong></td>
<td>Makes the field mandatory.</td>
</tr>
<tr>
<td><strong>@EMail</strong></td>
<td>Checks input against a (very good) regular expression to test for valid e-mail pattern.</td>
</tr>
<tr>
<td><strong>@Compare</strong></td>
<td>Compares with another field, usually for password comparison.</td>
</tr>
<tr>
<td><strong>@Custom</strong></td>
<td>Provide a static validation function as a callback for any custom validation.</td>
</tr>
</tbody>
</table>
<h3 id="ui-decorators-property-level">UI Decorators (property level)<a class="headerlink" href="#ui-decorators-property-level" title="Permanent link">#</a></h3>
<p>UI decorators control the appearance of elements. Not all have an immediate effect, but it's very helpful while creating components to have meta data available.</p>
<table>
<thead>
<tr>
<th>Decorator</th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>@Display</strong></td>
<td>Determine the label's name and an (optional) tooltip.</td>
</tr>
<tr>
<td><strong>@DisplayGroup</strong></td>
<td>Groups components in <code>&lt;fieldset&gt;</code> elements. Can be ordered inside the form.</td>
</tr>
<tr>
<td><strong>@Hidden</strong></td>
<td>Makes an hidden field.</td>
</tr>
<tr>
<td><strong>@Sortable</strong></td>
<td>Makes a column sortable in table views.</td>
</tr>
<tr>
<td><strong>@Filterable</strong></td>
<td>Adds a filter in table views.</td>
</tr>
<tr>
<td><strong>@Placeholder</strong></td>
<td>A watermark that appears in empty form fields</td>
</tr>
<tr>
<td><strong>@ReadOnly</strong></td>
<td>Forces a particular render type.</td>
</tr>
<tr>
<td><strong>@TemplateHint</strong></td>
<td>What kind of field (text, number, date, ...) and additional styles or classes.</td>
</tr>
</tbody>
</table>
<p>The UI decorators do not enforce any specific behavior. In fact, they do almost nothing in an application without explicit support. The decorators create hidden properties you can retrieve when building the UI. That way you can control the behavior of the app by setting the decorators. It's some sort of abstraction between the view model and the UI.</p>
<h4 id="mapping-the-properties">Mapping the Properties<a class="headerlink" href="#mapping-the-properties" title="Permanent link">#</a></h4>
<p>The actual properties are of the form <em>__propName__fieldName</em>, that means, you have to add the decorated property name at the end to retrieve the property specific value. As an example, the <em><strong>displayText</strong></em> property, created by the decorator <code>@Display</code>, and placed on a property <em>email</em>, can be retrieved by this code:</p>
<pre><code class="ts">const text = this.model['__displayText__email'];
</code></pre>

<p>However, the internal names may change and to avoid any issues a mapping with external names is available. The following table shows the properties the decorators create.</p>
<table>
<thead>
<tr>
<th>Decorator function</th>
<th>Properties</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Display</strong></td>
<td><code>text</code>, <code>order</code>, <code>desc</code></td>
</tr>
<tr>
<td><strong>DisplayGroup</strong></td>
<td><code>grouped</code>, <code>name</code>, <code>order</code>, <code>desc</code></td>
</tr>
<tr>
<td><strong>Hidden</strong></td>
<td><code>is</code></td>
</tr>
<tr>
<td><strong>Sortable</strong></td>
<td><code>is</code></td>
</tr>
<tr>
<td><strong>Filterable</strong></td>
<td><code>is</code></td>
</tr>
<tr>
<td><strong>Placeholder</strong></td>
<td><code>has</code>, <code>text</code></td>
</tr>
<tr>
<td><strong>ReadOnly</strong></td>
<td><code>is</code></td>
</tr>
<tr>
<td><strong>TemplateHint</strong></td>
<td><code>has</code>, <code>params</code>, <code>name</code></td>
</tr>
</tbody>
</table>
<h4 id="special-decorators">Special Decorators<a class="headerlink" href="#special-decorators" title="Permanent link">#</a></h4>
<p>There is one more decorator that's not just defining the UI behavior but has some internal behavior.</p>
<table>
<thead>
<tr>
<th>Decorator</th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>@Translate</strong></td>
<td>For i18n of components</td>
</tr>
</tbody>
</table>
<p>This decorator can be placed on top of the view model, on class level, or on a specific property.</p>
<pre><code class="ts">export class ContactModel {

  constructor(init?: ContactModel) {
    if (init) {
      this.name = init.name;
      this.email = init.email;
    }
  }

  @Translate(json)
  @Display('Contact Name')
  @Required()
  name = '';
}
</code></pre>

<p>The function expects a JSON file with translation instructions. The translation converts the text on the properties to another language:</p>
<pre><code class="js">const json = {
  'Contact Name': 'Kontaktname'
};
</code></pre>

<p>This decorator is experimental and will change in the near future to reflect a more powerful approach.</p>
<h3 id="providing-the-viewmodel">Providing the ViewModel<a class="headerlink" href="#providing-the-viewmodel" title="Permanent link">#</a></h3>
<p>To make a ViewModel accessible you use the <code>@ViewModel(T)</code> decorator. More about this in the chapter <em>Data Binding</em>.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../nbind/" class="btn btn-neutral float-right" title="Data Binding">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../overview/" class="btn btn-neutral" title="Overview"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/joergkrause/nyaf/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../overview/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../nbind/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../../../..';</script>
    <script src="../../../../js/theme.js" defer></script>
      <script src="../../../../search/main.js" defer></script>

</body>
</html>
